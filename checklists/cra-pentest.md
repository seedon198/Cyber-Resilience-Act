# CRA-Aligned Penetration Testing Checklist

## Pre-Engagement Planning

### Scope Definition and Risk Assessment

**Legal and Regulatory Framework:**
- [ ] Verify CRA applicability to target products/systems
- [ ] Identify relevant harmonized standards and requirements
- [ ] Document client's compliance status and objectives
- [ ] Establish legal framework for testing activities
- [ ] Define incident response procedures for critical findings

**Technical Scope Assessment:**
- [ ] Catalog all digital products and components in scope
- [ ] Identify network architecture and segmentation
- [ ] Document communication protocols and interfaces
- [ ] Map supply chain components and dependencies
- [ ] Assess operational technology (OT) integration requirements

**Risk Classification and Testing Approach:**
- [ ] Determine CRA risk classification (Class I, II, or Critical)
- [ ] Align testing methodology with risk level requirements
- [ ] Define safety and operational continuity constraints
- [ ] Establish testing environment and isolation procedures
- [ ] Plan for third-party assessment coordination (if required)

## CRA Essential Requirements Testing

### Secure Design and Development Validation

**Architecture Security Assessment:**
- [ ] Verify security-by-design implementation
- [ ] Validate threat modeling against CRA requirements
- [ ] Assess defense-in-depth architecture implementation
- [ ] Review security requirement traceability
- [ ] Test fail-safe and fail-secure behaviors

**Secure Development Lifecycle (SDL) Review:**
- [ ] Verify secure coding practices implementation
- [ ] Validate security testing integration in CI/CD
- [ ] Review code security scanning and validation
- [ ] Assess third-party component security management
- [ ] Test security configuration management

### Vulnerability Management Testing

**Vulnerability Discovery and Assessment:**
- [ ] Conduct automated vulnerability scanning
- [ ] Perform manual security testing and validation
- [ ] Test vulnerability disclosure process functionality
- [ ] Validate vulnerability prioritization and risk assessment
- [ ] Verify coordination with ENISA reporting requirements

**Security Update and Patch Management:**
- [ ] Test security update delivery mechanisms
- [ ] Validate update authentication and integrity verification
- [ ] Assess rollback and recovery capabilities
- [ ] Test emergency patch deployment procedures
- [ ] Verify end-of-life security support planning

## Hardware and Firmware Security Testing

### Embedded System Security Assessment

**Firmware Security Analysis:**
- [ ] Extract and analyze firmware components
- [ ] Verify secure boot implementation and validation
- [ ] Test firmware update mechanisms and security
- [ ] Assess cryptographic implementation and key management
- [ ] Validate hardware security module (HSM) integration

**Hardware Interface Security:**
- [ ] Test debug interface access controls (JTAG, SWD)
- [ ] Assess UART and serial interface security
- [ ] Validate SPI/I2C communication security
- [ ] Test physical tamper detection and response
- [ ] Assess side-channel attack resistance

**IoT Device Specific Testing:**
- [ ] Test default credential security and management
- [ ] Validate device provisioning and identity management
- [ ] Assess wireless communication security (Wi-Fi, Bluetooth, etc.)
- [ ] Test cloud service integration security
- [ ] Validate data protection and privacy implementation

## Network and Communication Security

### Protocol Security Assessment

**Industrial Protocol Testing (ICS/OT):**
- [ ] Test Modbus TCP/RTU security implementation
- [ ] Assess DNP3 secure authentication and encryption
- [ ] Validate OPC UA security configuration and certificates
- [ ] Test CAN bus security and intrusion detection
- [ ] Assess network segmentation and access controls

**Standard Network Protocol Security:**
- [ ] Test TLS/SSL implementation and configuration
- [ ] Validate certificate management and PKI implementation
- [ ] Assess SSH configuration and key management
- [ ] Test VPN and remote access security
- [ ] Validate wireless security implementation (WPA3, etc.)

### Network Architecture Security:**
- [ ] Test network segmentation effectiveness
- [ ] Validate firewall and access control implementation
- [ ] Assess intrusion detection and monitoring capabilities
- [ ] Test network service discovery and enumeration resistance
- [ ] Validate secure remote access implementation

## Authentication and Access Control

### Identity and Access Management:**
- [ ] Test multi-factor authentication implementation
- [ ] Validate role-based access control (RBAC) effectiveness
- [ ] Assess privilege escalation resistance
- [ ] Test session management and timeout controls
- [ ] Validate single sign-on (SSO) security integration

**Cryptographic Implementation:**
- [ ] Test symmetric and asymmetric encryption implementation
- [ ] Validate key generation, storage, and management
- [ ] Assess random number generation quality
- [ ] Test digital signature implementation and validation
- [ ] Validate cryptographic protocol implementation (TLS, IPSec)

## Data Protection and Privacy

### Data Security Assessment:**
- [ ] Test data encryption at rest and in transit
- [ ] Validate data classification and handling procedures
- [ ] Assess data retention and disposal mechanisms
- [ ] Test data backup and recovery security
- [ ] Validate data loss prevention (DLP) controls

**Privacy Implementation Testing:**
- [ ] Verify GDPR compliance integration with CRA requirements
- [ ] Test consent management and user control mechanisms
- [ ] Validate data minimization and purpose limitation
- [ ] Assess cross-border data transfer security
- [ ] Test privacy-by-design implementation

## Incident Detection and Response

### Security Monitoring and Detection:**
- [ ] Test security information and event management (SIEM) effectiveness
- [ ] Validate intrusion detection and prevention system (IDS/IPS) capabilities
- [ ] Assess anomaly detection and behavioral analysis
- [ ] Test log collection, retention, and analysis
- [ ] Validate threat intelligence integration

**Incident Response Capability:**
- [ ] Test incident detection and alerting mechanisms
- [ ] Validate incident classification and prioritization
- [ ] Assess incident containment and eradication procedures
- [ ] Test communication and notification processes
- [ ] Validate recovery and lessons learned integration

## Supply Chain and Third-Party Security

### Component Security Assessment:**
- [ ] Validate third-party component security verification
- [ ] Test software bill of materials (SBOM) accuracy and completeness
- [ ] Assess dependency scanning and vulnerability management
- [ ] Test component authentication and integrity verification
- [ ] Validate supplier security requirement enforcement

**Manufacturing and Distribution Security:**
- [ ] Test manufacturing process security controls
- [ ] Validate product integrity throughout supply chain
- [ ] Assess distribution channel security
- [ ] Test product authentication and anti-counterfeiting measures
- [ ] Validate secure provisioning and configuration processes

## Documentation and User Guidance

### Security Documentation Assessment:**
- [ ] Verify security configuration guidance completeness and accuracy
- [ ] Test user security training and awareness materials
- [ ] Validate incident reporting and response user procedures
- [ ] Assess security best practice documentation
- [ ] Test documentation accessibility and usability

**Compliance Documentation:**
- [ ] Verify conformity assessment documentation completeness
- [ ] Validate technical documentation accuracy and completeness
- [ ] Assess risk assessment and mitigation documentation
- [ ] Test security testing and validation evidence
- [ ] Validate ongoing compliance monitoring documentation

## Post-Testing Activities

### Finding Classification and Prioritization:**
- [ ] Classify findings according to CRA essential requirements
- [ ] Prioritize remediation based on regulatory compliance impact
- [ ] Assess business risk and operational impact
- [ ] Coordinate with client compliance and legal teams
- [ ] Document recommendations for regulatory reporting

**Remediation Planning and Validation:**
- [ ] Develop remediation roadmap aligned with CRA timeline
- [ ] Coordinate with notified body requirements (if applicable)
- [ ] Plan for re-testing and validation activities
- [ ] Establish ongoing monitoring and assessment procedures
- [ ] Document lessons learned and best practices

## Regulatory Reporting and Coordination

### Authority Interaction:**
- [ ] Prepare documentation for market surveillance authorities
- [ ] Coordinate with ENISA reporting requirements (if applicable)
- [ ] Document compliance status and remediation plans
- [ ] Establish ongoing regulatory communication procedures
- [ ] Plan for audit and assessment cooperation

**Continuous Compliance Monitoring:**
- [ ] Establish regular penetration testing schedule
- [ ] Plan for regulatory change monitoring and adaptation
- [ ] Coordinate with industry best practice evolution
- [ ] Document compliance posture for ongoing assessment
- [ ] Establish improvement planning and implementation procedures

---

**Testing Tools and Resources:**

**Commercial Tools:**
- Nessus, Qualys, or similar vulnerability scanners
- Burp Suite Professional or similar web application security testing
- Metasploit or similar penetration testing frameworks
- Hardware security testing tools (ChipWhisperer, JTAGulator)

**Open Source Tools:**
- OpenVAS for vulnerability scanning
- OWASP ZAP for web application security testing
- Nmap for network discovery and security scanning
- Binwalk and Ghidra for firmware analysis

**CRA-Specific Resources:**
- ENISA guidelines and technical reports
- EU Commission implementing acts and standards
- Industry-specific CRA guidance documents
- Notified body assessment criteria and procedures

---

*This checklist should be adapted based on specific client requirements, product types, and risk classifications. Professional legal and regulatory consultation is recommended for complex scenarios.*

*Last Updated: July 2025*
